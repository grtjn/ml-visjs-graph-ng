# MarkLogic VisJS Graph Visualization

This AngularJS library allows you to easily produce a graph visualization for
triples stored in MarkLogic, based on the [VisJS Network
library](http://visjs.org/docs/network/). It is specifically designed with
applications generated by the [MarkLogic SlushJS
generator](https://github.com/marklogic/slush-marklogic-node) in mind.

## Getting Started

Install this library:

    bower install ml-visjs-graph-ng --save

Install the [mlpm module](https://github.com/patrickmcelwee/mlpm-visjs-graph):

    npm install -g mlpm
    mlpm install visjs-graph --save
    mlpm deploy -H localhost -P 8040 -u admin -p admin

### Enable the triple index

Since this library works based on SPARQL queries against triples stored
in your MarkLogic database, you need to enable the triple index. 

#### Using Roxy

You should do this in `deploy/ml-config.xml` of your application.
Add the following line to the `<database></database>` configuration for the
database with name `<database-name>${content-db}</database-name>` (around line
179 at the time of this writing).

```xml
      <triple-index>true</triple-index>
```

#### Using ml-gradle

Update the ```src/main/ml-config/databases/content-database.json``` file for your application 
to include the following property:

```json
  "triple-index": true
```

## Example Implementation

Add the `ml.visjsGraph` module as a dependency to your app.module. For
example, in a [slush-generated
app](https://github.com/marklogic/slush-marklogic-node), add this to
`ui/app/app.js`:

```javascript
angular.module('app', [
   # ...
  'ml.visjsGraph',
  # ...
]);
```

You can add a VisJS graph for a document by adding the following HTML snippet
to a template, for example to `ui/app/detail/detail.html`:

```html
<visjs-graph uris="[ctrl.uri]"></visjs-graph>
```

NOTE: Support for multiple uris is not yet provided, but that future extension
is anticipated by this API. For now, it will only initialize the graph
visualization with the first uri in the list provided to the directive.

## Sample Data

The original [slush-generated
app](https://github.com/marklogic/slush-marklogic-node) comes with 3000 JSON
documents representing people. For the moment, those documents do not include
triples.

This code repository has the same JSON documents, enriched with triples
representing foaf:knows relationships, an rdf:type, and an rdfs:label for each
document. One document also includes a rdfs:label for foaf:knows, so that it
displays on the graph as 'knows' rather than the more verbose 'foaf:knows'. To
use, you can replace the original `sample-data.zip` file in the slush-generated
app with the `sample-data.zip` file in this project. (Eventually, the
slush-generated app may use this project's version with triples.)

Then, you can load them with
(MLCP)[https://docs.marklogic.com/guide/ingestion/content-pump] like this:

    ./ml local mlcp -options_file import-sample-data.options

Or on Windows:

    ml.bat local mlcp -options_file import-sample-data.options

## Directives Provided

### `visjs-graph`

TODO

