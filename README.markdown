# MarkLogic VisJS Graph Visualization

This AngularJS library allows you to easily produce a graph visualization for
triples stored in MarkLogic, based on the [VisJS Network
library](http://visjs.org/docs/network/). It is specifically designed with
applications generated by the [MarkLogic SlushJS
generator](https://github.com/marklogic/slush-marklogic-node) in mind.

## Getting Started

Install this library:

    bower install ml-visjs-graph-ng --save

Install the [mlpm module](https://github.com/patrickmcelwee/mlpm-visjs-graph):

    npm install -g mlpm
    mlpm install visjs-graph --save
    mlpm deploy -H localhost -P 8040 -u admin -p admin

Also, since this library works based on SPARQL queries against triples stored
in your MarkLogic database, you need to enable the triple index. Unless you
know better, you should do this in `deploy/ml-config.xml` of your application.
Add the following line to the `<database></database>` configuration for the
database with name `<database-name>${content-db}</database-name>` (around line
179 at the time of this writing).

```xml
      <triple-index>true</triple-index>
```

## Example Implementation

Add the `ml.visjsGraph` module as a dependency to your app.module. For
example, in a [slush-generated
app](https://github.com/marklogic/slush-marklogic-node), add this to
`ui/app/app.js`:

```javascript
angular.module('app', [
   # ...
  'ml.visjsGraph,
  # ...
]);
```

You can add a link to the VisJS graph for a document by adding the following
HTML snippet to a template:

```html
<a ui-sref="root.visjs-graph({uri: docUri})">Go to the VisJS graph for {{docUri}}</a>
```

For example, in a slush-generated app, you can add this markup to
`ui/app/detail/detail.html`:

```html
<div class="col-sm-4">
  <div class="panel panel-default">
    <div class="panel-heading">Graph</div>
    <div class="panel-body" style="min-height: 50px;">
      Explore triples for <a ui-sref="root.visjs-graph({uri: ctrl.uri})">{{ctrl.uri}}</a>
    </div>
  </div>
</div>
```

## Sample Data

The original [slush-generated
app](https://github.com/marklogic/slush-marklogic-node) comes with 3000 JSON
documents representing people. For the moment, those documents do not include
triples.

This code repository has the same JSON documents, enriched with triples
representing foaf:knows relationships, an rdf:type, and an rdfs:label for each
document. To use, you can replace the original `sample-data.zip` file in the
slush-generated app with the `sample-data.zip` file in this project.
(Eventually, the slush-generated app may use this project's version with
triples.)

Then, you can load them with
(MLCP)[https://docs.marklogic.com/guide/ingestion/content-pump] like this:

    ./ml local mlcp -options_file import-sample-data.options

Or on Windows:

    ml.bat local mlcp -options_file import-sample-data.options

## Directives Provided

TODO

